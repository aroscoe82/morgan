{"version":3,"sources":["scripts/app-48086af607.js"],"names":["angular","module","google","load","controller","$scope","$timeout","$interval","Fullscreen","morganFactory","init","getSource","then","response","sourceList","data","key","sourceLoop","displayBlocks","displayScroll","index","display","displayBlock","scrollList","length","scrollItem","Math","floor","random","horizontalScroll","content","setInterval","sourceIndex","showTimeout","hideTimeout","posX","posY","pos","top","left","setTimeout","isVisible","$apply","source","refresh","getData","type","getTimeData","getOpenWeatherData","getRss","currentDate","Date","toLocaleDateString","navigator","language","weekday","year","month","day","getHours","getMinutes","getAnyUrl","url","query","results","channel","location","city","item","condition","temp","code","feed","feeds","Feed","setNumEntries","result","cleanScrolls","id","entries","entry","title","push","i","splice","fullscreen","hideScroll","showButton","goFullscreen","toggleAll","config","$stateProvider","$urlRouterProvider","state","templateUrl","otherwise","factory","$http","urlSource","dataFactory","get","run","$templateCache","put"],"mappings":"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","file":"scripts/app-48086af607.js","sourcesContent":["angular.module('morgan', ['ui.router', 'FBAngular', 'ngAnimate', 'ngSanitize']);\n\ngoogle.load(\"feeds\", \"1\");\n\nangular.module(\"morgan\").controller(\"morganCtrl\", [\n    \"$scope\",\n    \"$timeout\",\n    \"$interval\",\n    \"Fullscreen\",\n    \"morganFactory\",\n    function($scope, $timeout, $interval, Fullscreen, morganFactory) {\n        \n        $scope.isVisible = false;\n        $scope.fullscreen = false;\n        $scope.hideScroll = false;\n        \n        $scope.sourceList = [];\n        $scope.scrollList = [];\n        $scope.horizontalScroll = \"\";\n        \n        $scope.showButton = true;\n        \n        function init() {\n            morganFactory.getSource()\n                .then(function(response) {\n                    $scope.sourceList = response.data;\n                    for (key in $scope.sourceList) {\n                        sourceLoop($scope.sourceList[key]);\n                    }\n                    displayBlocks();\n                });\n                displayScroll();\n        }\n        \n        function displayBlocks() {\n            for (index in $scope.sourceList) {\n                if ($scope.sourceList[index].display === \"block\") {\n                    displayBlock(index);\n                }\n            }\n        }\n        \n        function displayScroll() {\n            if ($scope.scrollList.length > 0) {\n                // Pick a random element in $scope.scrollList\n                var scrollItem = Math.floor(Math.random()*$scope.scrollList.length);\n                $scope.horizontalScroll = $scope.scrollList[scrollItem].content;\n            }\n            setInterval(function() {\n                if ($scope.scrollList.length > 0) {\n                    // Pick a random element in $scope.scrollList\n                    var scrollItem = Math.floor(Math.random()*$scope.scrollList.length);\n                    $scope.horizontalScroll = $scope.scrollList[scrollItem].content;\n                }\n            }, 30*1000);\n        }\n        \n        function displayBlock(sourceIndex) {\n            var showTimeout = Math.floor((Math.random()*20)+5)*1000;\n            var hideTimeout = Math.floor((Math.random()*10)+5)*1000;\n            var posX = Math.floor((Math.random()*60)+20);\n            var posY = Math.floor((Math.random()*60)+20);\n            \n            $scope.sourceList[sourceIndex].pos.top = posX;\n            $scope.sourceList[sourceIndex].pos.left = posY;\n            setTimeout(function() {\n                $scope.sourceList[sourceIndex].isVisible = true;\n                $scope.$apply();\n                setTimeout(function() {\n                    $scope.sourceList[sourceIndex].isVisible = false;\n                    $scope.$apply();\n                    displayBlock(sourceIndex)\n                }, hideTimeout);\n\n            }, showTimeout);\n        }\n        \n        function sourceLoop(source) {\n            if (source.refresh) {\n                getData(source);\n                setInterval(function() {\n                    getData(source);\n                }, source.refresh*1000);\n            } else {\n                getData(source);\n            }\n        }\n        \n        function getData(source) {\n            switch (source.type) {\n                case \"time\":\n                    source.isVisible = false;\n                    source.content = \"\";\n                    source.pos = { top: 0, left: 0 };\n                    getTimeData(source);\n                    break;\n                case \"yahooWeather\":\n                    source.isVisible = false;\n                    source.content = \"meteo\";\n                    source.pos = { top: 0, left: 0 };\n                    getOpenWeatherData(source);\n                    break;\n                case \"rss\":\n                    source.isVisible = false;\n                    source.content = \"rss\";\n                    source.pos = { top: 0, left: 0 };\n                    getRss(source);\n                    break;\n            }\n        }\n        \n        function getTimeData(source) {\n            var currentDate = new Date();\n            source.content = currentDate.toLocaleDateString(navigator.language, {weekday: \"long\", year: \"numeric\", month: \"long\", day: \"numeric\"}) + \"<br>\" +\n                            (currentDate.getHours()<10?\"0\":\"\") + currentDate.getHours() + \":\" + (currentDate.getMinutes()<10?\"0\":\"\") + currentDate.getMinutes();\n        }\n        \n        function getOpenWeatherData(source) {\n            morganFactory.getAnyUrl(source.url)\n                .then(function(response) {\n                    source.content = response.data.query.results.channel.location.city + \"<br>\" +\n                                    response.data.query.results.channel.item.condition.temp + \" Â°C\" + \"\\n\" + \"<br>\" +\n                                    \"<img src=\\\"http://l.yimg.com/a/i/us/we/52/\" + response.data.query.results.channel.item.condition.code + \".gif\\\" alt=\\\"condition\\\">\"\n                                    \n                });\n        }\n        \n        function getRss(source) {\n            var feed = new google.feeds.Feed(source.url);\n\t\t\tfeed.setNumEntries(10);\n\t\t\tfeed.load(function(result) {\n                cleanScrolls(source.id);\n                for (key in result.feed.entries) {\n                    var entry = {};\n                    entry.id = source.id;\n                    entry.content = result.feed.entries[key].title;\n                    $scope.scrollList.push(entry);\n                    $scope.horizontalScroll = entry.content;\n                }\n\t\t\t});\n        }\n        \n        function cleanScrolls(id) {\n            for (var i=$scope.scrollList.length-1; i>=0; i--) {\n                if ($scope.scrollList[i].id === id) {\n                    $scope.scrollList.splice(i, 1);\n                }\n            }\n        }\n        \n        $scope.goFullscreen = function () {\n            Fullscreen.toggleAll();\n            $scope.showButton = !$scope.showButton;\n            /*console.log(Fullscreen);\n            if (Fullscreen.isFullscreen()) {\n                $scope.fullscreen = false;\n                Fullscreen.cancel();\n            } else {\n                $scope.fullscreen = true;\n                Fullscreen.all();\n            }*/\n        }\n\n        function showAndHideBlock(element) {\n            if (element.type === \"block\") {\n                var showTimeout = Math.floor((Math.random()*6)+1)*1000;\n                var hideTimeout = Math.floor((Math.random()*6)+1)*1000;\n                var posX = Math.floor((Math.random()*90));\n                var posY = Math.floor((Math.random()*90));\n                \n                element.pos.top = posX;\n                element.pos.left = posY;\n                $timeout(function() {\n                    element.isVisible = true;\n                    $timeout(function() {\n                        element.isVisible = false;\n                    }, showTimeout);\n\n                }, hideTimeout);\n            } else if (element.type === \"scroll\") {\n                $scope.hideScroll = true;\n            }\n        }\n        \n        function scrollBlock(element) {\n        }\n        \n        init();\n    }\n]);\n\nangular.module('morgan')\n    .config(function ($stateProvider, $urlRouterProvider) {\n        $stateProvider\n            .state('main', {\n                url: '/',\n                templateUrl: 'app/main/main.html'\n            });\n            \n        $urlRouterProvider.otherwise('/');\n    });\n\nangular.module('morgan')\n    .factory('morganFactory', ['$http', function($http) {\n\n    var urlSource = \"sources.json\";\n    var dataFactory = {};\n\n    dataFactory.getSource = function () {\n        return $http.get(urlSource);\n    };\n    \n    dataFactory.getAnyUrl = function(url) {\n        return $http.get(url);\n    };\n\n    return dataFactory;\n}]);\n\nangular.module(\"morgan\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/main/main.html\",\"<div class=\\\"container\\\" id=\\\"mainContainer\\\" data-ng-controller=\\\"morganCtrl\\\" data-fullscreen=\\\"\\\"><button type=\\\"button\\\" data-ng-click=\\\"goFullscreen()\\\" data-ng-if=\\\"showButton\\\">Fullsreen</button><div data-ng-repeat=\\\"source in sourceList\\\"><div class=\\\"component block\\\" data-ng-class=\\\"{visible: source.isVisible, invisible: !source.isVisible}\\\" data-ng-style=\\\"{\\'top\\': source.pos.top + \\'%\\', \\'left\\': source.pos.left + \\'%\\'}\\\" data-ng-bind-html=\\\"source.content\\\"></div></div><div class=\\\"component marquee\\\">{{horizontalScroll}}</div></div>\");}]);"],"sourceRoot":"/source/"}