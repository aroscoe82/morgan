angular.module("morgan",["ui.router","FBAngular","ngAnimate","ngSanitize"]),google.load("feeds","1"),angular.module("morgan").controller("morganCtrl",["$scope","$q","$timeout","$interval","Fullscreen","morganFactory",function(t,o,e,n,i,a){function r(){s(),l()}function s(){o.all([a.getSource(),a.getConfig()]).then(function(o){t.sourceList=o[0].data,t.config=o[1].data;for(key in t.sourceList)d(t.sourceList[key]);c(),u()})}function l(){setInterval(function(){a.getConfig().then(function(o){o.data.lastupdate&&o.data.lastupdate>t.config.lastupdate&&(t.config=o.data,a.getSource().then(function(o){t.sourceList=o.data;for(key in t.sourceList)d(t.sourceList[key]);c(),u()}))})},36e5)}function c(){for(index in t.sourceList)"block"===t.sourceList[index].display&&f(index)}function u(){if(t.scrollList.length>0){var o=Math.floor(2*Math.random());if(0===o){var e=Math.floor(Math.random()*t.scrollList.length);t.horizontalScroll=t.scrollList[e].content}else t.horizontalScroll=""}else t.horizontalScroll="";setInterval(function(){if(t.scrollList.length>0){var o=Math.floor(2*Math.random());if(0===o){var e=Math.floor(Math.random()*t.scrollList.length);t.horizontalScroll=t.scrollList[e].content}else t.horizontalScroll=""}},2e4)}function f(o){var e=1e3*Math.floor(20*Math.random()+5),n=1e3*Math.floor(10*Math.random()+5),i=Math.floor(60*Math.random()+20),a=Math.floor(60*Math.random()+20);t.sourceList[o].pos.top=i,t.sourceList[o].pos.left=a,setTimeout(function(){t.sourceList[o].isVisible=!0,t.$apply(),setTimeout(function(){t.sourceList[o].isVisible=!1,t.$apply(),f(o)},n)},e)}function d(t){t.refresh?(g(t),setInterval(function(){g(t)},1e3*t.refresh)):g(t)}function g(t){switch(t.type){case"time":t.isVisible=!1,t.content="",t.pos={top:0,left:0},h(t);break;case"yahooWeather":t.isVisible=!1,t.content="meteo",t.pos={top:0,left:0},p(t);break;case"openWeather":t.isVisible=!1,t.content="meteo",t.pos={top:0,left:0},m(t);break;case"rss":t.isVisible=!1,t.content="rss",t.pos={top:0,left:0},y(t)}}function h(o){var e=new Date;o.content=e.toLocaleDateString(t.config.lang,{weekday:"long",year:"numeric",month:"long",day:"numeric"})+"<br>"+(e.getHours()<10?"0":"")+e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes()}function p(t){a.getAnyUrl(t.url).then(function(o){t.content=o.data.query.results.channel.location.city+"<br>"+o.data.query.results.channel.item.condition.temp+' °C<br><img src="http://l.yimg.com/a/i/us/we/52/'+o.data.query.results.channel.item.condition.code+'.gif" alt="condition">'})}function m(o){if(o.id&&t.config.openweatherAppId){var e="http://api.openweathermap.org/data/2.5/weather?id="+o.locationId+"&appId="+t.config.openweatherAppId,n=" °C";t.config.units&&(e+="&units="+t.config.units,"imperial"===t.config.units&&(n=" °F")),t.config.lang&&(e+="&lang="+t.config.lang),a.getAnyUrl(e).then(function(t){var e=new Date,i=new Date;e.setUTCSeconds(t.data.sys.sunrise),i.setUTCSeconds(t.data.sys.sunset),o.content=t.data.name+"<br>"+t.data.weather[0].description+"<br>"+t.data.main.temp+n+'<br/><i class="owf owf-'+t.data.weather[0].id+' owf-3x">'})}}function y(o){t.showScroll=!1;var e=new google.feeds.Feed(o.url);e.setNumEntries(10),e.load(function(e){v(o.id);for(key in e.feed.entries){var n={};n.id=o.id,n.content=e.feed.entries[key].title,t.scrollList.push(n)}t.showScroll=!0})}function v(o){for(var e=t.scrollList.length-1;e>=0;e--)t.scrollList[e].id===o&&t.scrollList.splice(e,1)}t.isVisible=!1,t.fullscreen=!1,t.showScroll=!1,t.config={},t.sourceList=[],t.scrollList=[],t.horizontalScroll="",t.showButton=!0,t.goFullscreen=function(){i.toggleAll(),t.showButton=!t.showButton},r()}]),angular.module("morgan").config(["$stateProvider","$urlRouterProvider",function(t,o){t.state("main",{url:"/",templateUrl:"app/main/main.html"}),o.otherwise("/")}]),angular.module("morgan").factory("morganFactory",["$http",function(t){var o="sources.json",e="config.json",n={};return n.getSource=function(){return t.get(o)},n.getConfig=function(){return t.get(e)},n.getAnyUrl=function(o){return t.get(o)},n}]),angular.module("morgan").run(["$templateCache",function(t){t.put("app/main/main.html",'<div class="container" id="mainContainer" data-ng-controller="morganCtrl" data-fullscreen=""><button type="button" data-ng-click="goFullscreen()" data-ng-if="showButton">Fullsreen</button><div data-ng-repeat="source in sourceList"><div class="component block" data-ng-class="{visible: source.isVisible, invisible: !source.isVisible}" data-ng-style="{\'top\': source.pos.top + \'%\', \'left\': source.pos.left + \'%\'}" data-ng-bind-html="source.content"></div></div><div class="component" data-ng-class="{\'marquee\': showScroll, \'stopped\': !showScroll}">{{horizontalScroll}}</div></div>')}]);
//# sourceMappingURL=../maps/scripts/app-62847ceacb.js.map
